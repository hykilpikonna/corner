import{t as g,B as w,C as y,_ as v,c as r,o as c,a as i,F as h,r as p,n as b,z as _}from"./index-B2-0DWq1.js";var C=Object.getOwnPropertyDescriptor,k=(e,t,o,s)=>{for(var n=s>1?void 0:s?C(t,o):t,d=e.length-1,l;d>=0;d--)(l=e[d])&&(n=l(n)||n);return n};function m(e){return Array.from(e).reduce((t,o)=>(t+o.charCodeAt(0)*65535)%22859,0)/22859}async function $(e,t=100){return new Promise(o=>{const s=()=>{let n=e();n?o(n):setTimeout(s,t)};s()})}let u=class extends w{photos;photoRows;async created(){this.photos=await(await fetch("https://p.aza.moe/photos")).json(),this.photos.sort((o,s)=>o.exif.DateTime<s.exif.DateTime?1:-1);let e={1:0,2:.3,3:.5};this.photoRows=[];let t=[];this.photos.forEach(o=>{t.length===0?t.push(o):t.length>=3?(this.photoRows.push(t),t=[o]):m(o.original_photo)<e[t.length]?(this.photoRows.push(t),t=[o]):t.push(o)}),t.length>0&&this.photoRows.push(t)}async mounted(){this.$route.params.id&&(await $(()=>document.getElementById(`photo-${this.$route.params.id}`))).click()}url(e){return e=e.replace("data/photos","static").replace("./",""),`https://p.aza.moe/${e}`}randomRotation(e){return`rotate(${m(e)*20-10}deg)`}async clickPhoto(e,t){console.log("Clicked photo:",e.id);const o=t.currentTarget,s=o.querySelector(".photo-wrapper");s.style.viewTransitionName=`photo-${e.id}`,await document.startViewTransition(()=>{o.classList.toggle("active"),document.getElementsByClassName("blur")[0].toggleAttribute("hidden")}).finished,s.style.viewTransitionName=""}};u=k([y({})],u);const R=g(u),T="/thumb%20tack%202%20plain.png",B={class:"outer-grid"},P=["onClickCapture","id"],j=["src","alt"],E={class:"photo-abs-container",absolute:"","inset-0":"",flex:"","justify-center":"","items-center":""},z=["src","alt"];function x(e,t,o,s,n,d){return c(),r(h,null,[t[1]||(t[1]=i("div",{class:"title"},[i("div",{class:"font-script-en bold"},"The Wandering Gallery"),i("div",{class:"subtitle <sm:hidden"},"想要把旅行中用相机拍到好看照片时的喜悦分享给照片里出现的路人，所以买了便携照片打印机、搭了这个网页！")],-1)),i("div",B,[(c(!0),r(h,null,p(e.photoRows,l=>(c(),r("div",{key:l[0].id,flex:"","justify-center":"",class:b(`grid-cols-${l.length}`)},[(c(!0),r(h,null,p(l,a=>(c(),r("div",{key:a.id,onClickCapture:async f=>await e.clickPhoto(a,f),class:"img-container","cursor-pointer":"",id:`photo-${a.id}`},[i("img",{class:"photo","w-full":"","h-full":"","object-contain":"","opacity-0":"",src:e.url(a.thumbnail_edited),alt:a.id},null,8,j),i("div",E,[i("div",{class:"photo-wrapper",style:_({transform:e.randomRotation(a.id)})},[i("img",{class:"photo","w-full":"","object-contain":"",src:e.url(a.thumbnail_edited),alt:a.id},null,8,z)],4)]),t[0]||(t[0]=i("div",{flex:"","w-full":"","justify-center":"",absolute:"","position-top-none":""},[i("img",{class:"pin",src:T,alt:""})],-1))],40,P))),128))],2))),128))]),t[2]||(t[2]=i("div",{class:"blur",hidden:"","pos-fixed":"","inset-0":"","backdrop-blur-sm":"","z-5":""},null,-1))],64)}const D=v(R,[["render",x],["__scopeId","data-v-617868e5"]]);export{D as default};
