import{t as g,B as w,C as y,_ as v,c as l,o as c,a as i,F as h,r as p,n as _,z as b}from"./index-WCLYtkNE.js";var C=Object.getOwnPropertyDescriptor,$=(e,t,o,s)=>{for(var a=s>1?void 0:s?C(t,o):t,d=e.length-1,r;d>=0;d--)(r=e[d])&&(a=r(a)||a);return a};function m(e){return Array.from(e).reduce((t,o)=>(t+o.charCodeAt(0)*65535)%22859,0)/22859}async function k(e,t=100){return new Promise(o=>{const s=()=>{let a=e();a?o(a):setTimeout(s,t)};s()})}let u=class extends w{photos;photoRows;async created(){this.photos=await(await fetch("https://p.aza.moe/photos")).json(),this.photos.sort((o,s)=>o.exif.DateTime<s.exif.DateTime?1:-1);let e={1:0,2:.3,3:.5};this.photoRows=[];let t=[];this.photos.forEach(o=>{t.length===0?t.push(o):t.length>=3?(this.photoRows.push(t),t=[o]):m(o.original_photo)<e[t.length]?(this.photoRows.push(t),t=[o]):t.push(o)}),t.length>0&&this.photoRows.push(t)}async mounted(){this.$route.params.id&&(await k(()=>document.getElementById(`photo-${this.$route.params.id}`))).click()}url(e){return e=e.replace("data/photos","static").replace("./",""),`https://p.aza.moe/${e}`}randomRotation(e){return`rotate(${m(e)*20-10}deg)`}async clickPhoto(e,t){console.log("Clicked photo:",e.id);const o=t.currentTarget,s=o.querySelector(".photo-wrapper");s.style.viewTransitionName=`photo-${e.id}`,await document.startViewTransition(()=>{o.classList.toggle("active"),document.getElementsByClassName("blur")[0].toggleAttribute("hidden")}).finished,s.style.viewTransitionName=""}};u=$([y({})],u);const R=g(u),T={class:"outer-grid"},B=["onClickCapture","id"],P=["src","alt"],E={class:"photo-abs-container",absolute:"","inset-0":"",flex:"","justify-center":"","items-center":""},j=["src","alt"];function z(e,t,o,s,a,d){return c(),l(h,null,[t[0]||(t[0]=i("div",{class:"title"},[i("div",{class:"font-script-en bold"},"The Wandering Gallery"),i("div",{class:"subtitle <sm:hidden"},"想要把旅行中用相机拍到好看照片时的喜悦分享给幸运的路人，所以买了便携照片打印机、搭了这个网页！")],-1)),i("div",T,[(c(!0),l(h,null,p(e.photoRows,r=>(c(),l("div",{key:r[0].id,flex:"","justify-center":"",class:_(`grid-cols-${r.length}`)},[(c(!0),l(h,null,p(r,n=>(c(),l("div",{key:n.id,onClickCapture:async f=>await e.clickPhoto(n,f),class:"img-container","cursor-pointer":"",id:`photo-${n.id}`},[i("img",{class:"photo","w-full":"","h-full":"","object-contain":"","opacity-0":"",src:e.url(n.thumbnail_edited),alt:n.id},null,8,P),i("div",E,[i("div",{class:"photo-wrapper",style:b({transform:e.randomRotation(n.id)})},[i("img",{class:"photo","w-full":"","object-contain":"",src:e.url(n.thumbnail_edited),alt:n.id},null,8,j)],4)])],40,B))),128))],2))),128))]),t[1]||(t[1]=i("div",{class:"blur",hidden:"","pos-fixed":"","inset-0":"","backdrop-blur-sm":"","z-5":""},null,-1))],64)}const x=v(R,[["render",z],["__scopeId","data-v-5d364945"]]);export{x as default};
